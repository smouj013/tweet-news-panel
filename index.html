<!doctype html>
<html lang="es" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#070A12" />
  <meta name="description" content="News ‚Üí Tweet Template Panel (TNP) ‚Äî √öltima hora + plantilla Twitter/X" />
  <meta name="robots" content="noindex,nofollow" />

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./styles.css" />
  <title>TNP ‚Äî News ‚Üí Tweet Template Panel</title>
</head>

<body>
  <!-- TOPBAR -->
  <header class="topbar">
    <div class="topbar__left">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true">üõ∞Ô∏è</div>
        <div class="brand__text">
          <div class="brand__title">TNP</div>
          <div class="brand__sub">News ‚Üí Tweet Template Panel</div>
        </div>
      </div>

      <div class="controls">
        <label class="field">
          <span class="field__label">Ventana</span>
          <select id="timeFilter" class="input input--sm" title="Filtra noticias por las √∫ltimas horas">
            <option value="1">1h</option>
            <option value="3">3h</option>
            <option value="6">6h</option>
            <option value="12">12h</option>
            <option value="24" selected>24h</option>
            <option value="48">48h</option>
            <option value="72">72h</option>
          </select>
        </label>

        <label class="field field--grow">
          <span class="field__label">Buscar</span>
          <input id="searchBox" class="input input--sm" type="search" placeholder="Buscar titular / fuente‚Ä¶" autocomplete="off" />
        </label>

        <button id="btnRefresh" class="btn btn--primary btn--sm" type="button">Refrescar</button>
        <button id="btnFeeds" class="btn btn--sm" type="button">Feeds</button>
      </div>
    </div>

    <div class="topbar__right">
      <div class="sys">
        <button id="btnCheckUpdate" class="btn btn--sm" type="button" title="Busca actualizaci√≥n del Service Worker">Actualizar</button>
        <button id="btnHardReset" class="btn btn--danger btn--sm" type="button" title="Borra datos + vac√≠a cach√©s">Reset</button>
      </div>

      <div class="statusWrap">
        <div id="status" class="status" aria-live="polite">Listo</div>
      </div>
    </div>
  </header>

  <!-- TICKER (se rellena por JS, pero el layout lo define CSS) -->
  <section class="ticker" aria-label="Ticker en vivo">
    <div class="ticker__left">
      <span class="liveDot" aria-hidden="true"></span>
      <span class="ticker__label">LIVE</span>
    </div>

    <div class="ticker__track" aria-hidden="false">
      <div id="tnpTickerInner" class="ticker__inner" aria-live="polite" aria-atomic="true">
        <span class="tickerItem"><span class="tickerPill">news</span><span>Cargando titulares‚Ä¶</span></span>
        <span class="tickerItem"><span class="tickerPill">news</span><span>Cargando titulares‚Ä¶</span></span>
      </div>
    </div>

    <button id="tnpTrendsPop" class="trendChip" type="button" title="Click: a√±adir al campo HASHTAGS">
      <span class="trendChip__tag">#Tendencias</span>
      <span class="trendChip__meta">cargando‚Ä¶</span>
    </button>
  </section>

  <!-- MAIN -->
  <main class="layout">
    <!-- LEFT: COMPOSER -->
    <section class="panel panel--sticky">
      <div class="panel__header">
        <h2 class="panel__title">Plantilla</h2>
        <div class="mini muted">Generador de tweet</div>
      </div>

      <div class="grid">
        <label class="field">
          <span class="field__label">LIVE_URL</span>
          <input id="liveUrl" class="input" type="url" placeholder="https://twitch.com/globaleyetv" />
        </label>

        <label class="field">
          <span class="field__label">HEADLINE</span>
          <textarea id="headline" class="input input--area" rows="3" placeholder="Titular‚Ä¶"></textarea>
        </label>

        <label class="field">
          <span class="field__label">SOURCE_URL</span>
          <input id="sourceUrl" class="input" type="url" placeholder="https://‚Ä¶" />
        </label>

        <label class="field">
          <span class="field__label">HASHTAGS</span>
          <input id="hashtags" class="input" type="text" placeholder="#Espa√±a #√öltimaHora ‚Ä¶" />
        </label>

        <div class="row row--2">
          <label class="check">
            <input id="optIncludeLive" type="checkbox" checked />
            <span>Incluir üî¥#ENVIVO</span>
          </label>
          <label class="check">
            <input id="optIncludeSource" type="checkbox" checked />
            <span>Incluir Fuente</span>
          </label>
        </div>

        <label class="field">
          <span class="field__label">Template</span>
          <textarea id="template" class="input input--area mono" rows="8"></textarea>
        </label>

        <div class="row row--3">
          <button id="btnTrim" class="btn btn--sm" type="button">Ajustar 280</button>
          <button id="btnGenTags" class="btn btn--sm" type="button">Hashtags</button>
          <button id="btnResetTemplate" class="btn btn--sm" type="button">Reset template</button>
        </div>

        <div class="row row--3">
          <button id="btnCopy" class="btn btn--primary btn--sm" type="button">Copiar</button>
          <button id="btnX" class="btn btn--sm" type="button">Abrir X</button>
          <button id="btnCopyUrl" class="btn btn--sm" type="button">Copiar URL</button>
        </div>

        <div class="previewHead">
          <div class="mini muted">Preview</div>
          <div class="char">
            <span id="charCount">0</span><span class="muted">/280</span>
          </div>
        </div>

        <pre id="preview" class="preview" aria-label="Vista previa"></pre>

        <pre id="warn" class="warn hidden" aria-label="Avisos"></pre>
      </div>
    </section>

    <!-- RIGHT: FEEDS + LIST -->
    <section class="panel">
      <div class="panel__header">
        <h2 class="panel__title">√öltimas noticias</h2>
        <div class="mini muted">Selecciona una noticia y pulsa ‚ÄúUsar‚Äù</div>
      </div>

      <div class="filters">
        <label class="field field--inline">
          <span class="field__label">Delay</span>
          <input id="delayMin" class="input input--sm" type="number" min="0" max="120" value="10" />
          <span class="mini muted">min</span>
        </label>

        <label class="check">
          <input id="optOnlyReady" type="checkbox" />
          <span>Solo LISTO</span>
        </label>

        <label class="check">
          <input id="optOnlySpanish" type="checkbox" checked />
          <span>ES auto</span>
        </label>

        <label class="field field--inline">
          <span class="field__label">Orden</span>
          <select id="sortBy" class="input input--sm">
            <option value="recent" selected>Reciente</option>
            <option value="impact">Impacto</option>
            <option value="source">Fuente</option>
          </select>
        </label>

        <label class="field field--inline">
          <span class="field__label">Mostrar</span>
          <select id="showLimit" class="input input--sm">
            <option>10</option><option>15</option><option>20</option><option>30</option><option>50</option>
          </select>
        </label>

        <label class="field field--inline">
          <span class="field__label">Fetch cap</span>
          <select id="fetchCap" class="input input--sm">
            <option>160</option><option selected>240</option><option>360</option><option>600</option><option>900</option><option>1200</option>
          </select>
        </label>

        <label class="field field--inline">
          <span class="field__label">Batch</span>
          <select id="batchFeeds" class="input input--sm">
            <option>8</option><option selected>12</option><option>18</option><option>24</option><option>36</option><option>50</option>
          </select>
        </label>

        <label class="check">
          <input id="optAutoRefresh" type="checkbox" checked />
          <span>Auto</span>
        </label>

        <label class="field field--inline">
          <span class="field__label">Cada</span>
          <input id="refreshSec" class="input input--sm" type="number" min="15" max="600" value="30" />
          <span class="mini muted">s</span>
        </label>

        <label class="check">
          <input id="optResolveLinks" type="checkbox" checked />
          <span>Resolver links</span>
        </label>

        <label class="check">
          <input id="optShowOriginal" type="checkbox" checked />
          <span>Mostrar original</span>
        </label>

        <label class="check">
          <input id="optHideUsed" type="checkbox" />
          <span>Ocultar usados</span>
        </label>

        <label class="field field--inline">
          <span class="field__label">Cat</span>
          <select id="catFilter" class="input input--sm">
            <option value="all" selected>All</option>
            <option value="politics">Politics</option>
            <option value="economy">Economy</option>
            <option value="war">War</option>
            <option value="tech">Tech</option>
            <option value="crime">Crime</option>
            <option value="health">Health</option>
            <option value="sports">Sports</option>
            <option value="ent">Ent</option>
          </select>
        </label>
      </div>

      <div id="newsList" class="newsList" aria-label="Lista de noticias"></div>
    </section>
  </main>

  <!-- MODAL FEEDS -->
  <div id="modal" class="modal hidden" aria-hidden="true" role="dialog" aria-label="Gesti√≥n de feeds">
    <div class="modal__panel">
      <div class="modal__head">
        <div>
          <div class="modal__title">Feeds</div>
          <div class="mini muted">Activa/desactiva, edita o importa/exporta JSON</div>
        </div>
        <button id="btnCloseModal" class="btn btn--sm" type="button">Cerrar</button>
      </div>

      <div class="modal__body">
        <div class="row row--3">
          <input id="newFeedName" class="input input--sm" placeholder="Nombre" />
          <input id="newFeedUrl" class="input input--sm" placeholder="URL RSS/Atom/JSON" />
          <button id="btnAddFeed" class="btn btn--primary btn--sm" type="button">A√±adir</button>
        </div>

        <div id="feedList" class="feedList"></div>

        <label class="field">
          <span class="field__label">Import / Export (JSON)</span>
          <textarea id="feedsJson" class="input input--area mono" rows="7" placeholder='[ { "name": "...", "url": "...", "enabled": true } ]'></textarea>
        </label>

        <div class="row row--4">
          <button id="btnExportFeeds" class="btn btn--sm" type="button">Export</button>
          <button id="btnImportFeeds" class="btn btn--sm" type="button">Import</button>
          <button id="btnRestoreDefaultFeeds" class="btn btn--sm" type="button">Defaults</button>
          <button id="btnSaveFeeds" class="btn btn--primary btn--sm" type="button">Guardar</button>
        </div>

        <div class="mini muted">
          Tip: Shift+click en ‚ÄúRefrescar‚Äù = force + reset backoff.
        </div>
      </div>
    </div>
  </div>

  <script src="./app.js" defer></script>
</body>
</html>
