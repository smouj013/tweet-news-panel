<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#070A12" />
  <meta name="description" content="Panel PRO para extraer noticias (RSS/Atom/JSON), resolver link original, im√°genes y generar plantilla lista para X." />
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./assets/icons/favicon-32.png" sizes="32x32" />
  <link rel="icon" href="./assets/icons/icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="./assets/icons/apple-touch-icon-180.png" sizes="180x180" />

  <link rel="preconnect" href="https://news.google.com" crossorigin />
  <link rel="preconnect" href="https://api.allorigins.win" crossorigin />
  <link rel="preconnect" href="https://r.jina.ai" crossorigin />
  <link rel="preconnect" href="https://translate.googleapis.com" crossorigin />

  <link rel="preload" href="./styles.css" as="style" />
  <link rel="stylesheet" href="./styles.css" />

  <title>News ‚Üí Tweet Template Panel</title>
</head>

<body>
  <a class="skipLink" href="#main">Saltar a contenido</a>

  <!-- TOPBAR -->
  <header class="topbar" id="topbar">
    <div class="topbar__left">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true">üõ∞Ô∏è</div>
        <div class="brand__txt">
          <div class="brand__title">News ‚Üí Tweet Panel</div>
          <div class="brand__sub">PRO ¬∑ RSS/Atom/JSON ¬∑ Links reales ¬∑ Im√°genes</div>
        </div>
      </div>

      <div class="topbar__controls">
        <label class="field field--inline">
          <span class="field__label">Tiempo</span>
          <select id="timeFilter" class="input input--sm">
            <option value="all">Todo</option>
            <option value="10m">‚â§ 10 min</option>
            <option value="30m">‚â§ 30 min</option>
            <option value="1h">‚â§ 1 hora</option>
            <option value="2h">‚â§ 2 horas</option>
            <option value="24h">‚â§ 24 horas</option>
          </select>
        </label>

        <label class="field field--inline grow">
          <span class="field__label">Buscar</span>
          <input id="searchBox" class="input input--sm" placeholder="Filtra por t√≠tulo / dominio / keywords‚Ä¶" />
        </label>

        <button id="btnRefresh" class="btn btn--primary btn--sm" type="button" title="Refrescar feeds (Shift+Click = force)">
          Refrescar
        </button>

        <button id="btnFeeds" class="btn btn--sm" type="button">
          Feeds
        </button>
      </div>
    </div>

    <div class="topbar__right">
      <button id="btnCheckUpdate" class="btn btn--sm" type="button" title="Forzar comprobaci√≥n de actualizaci√≥n">
        Actualizar
      </button>
      <button id="btnHardReset" class="btn btn--danger btn--sm" type="button" title="Borra datos + cach√©s + Service Worker">
        Reset + Vaciar cach√©
      </button>

      <div id="status" class="status" aria-live="polite">Listo.</div>
    </div>
  </header>

  <!-- TICKER -->
  <section class="ticker" id="ticker" aria-label="Ticker">
    <div class="ticker__rail">
      <div class="ticker__label">√öLTIMA HORA</div>
      <div class="ticker__line">
        <div id="tnpTickerInner" class="ticker__inner">Cargando‚Ä¶</div>
      </div>
      <div id="tnpTrendsPop" class="ticker__pop" aria-hidden="true"></div>
    </div>
  </section>

  <!-- MAIN -->
  <main id="main" class="wrap">
    <div class="layout">
      <!-- LEFT: COMPOSER -->
      <section class="panel sticky">
        <div class="panel__head">
          <div class="panel__title">Generador de tweet</div>
          <div class="panel__sub">Selecciona una noticia y tendr√°s el tweet listo en tu plantilla.</div>
        </div>

        <div class="panel__body">
          <div class="grid2">
            <label class="field">
              <span class="field__label">üî¥ En vivo (URL)</span>
              <input id="liveUrl" class="input" value="https://twitch.com/globaleyetv" />
            </label>

            <label class="field">
              <span class="field__label">Hashtags</span>
              <input id="hashtags" class="input" placeholder="#ENVIVO #√öltimaHora ‚Ä¶" />
            </label>
          </div>

          <label class="field">
            <span class="field__label">Titular</span>
            <input id="headline" class="input" placeholder="üö® √öLTIMA HORA: ‚Ä¶" />
          </label>

          <label class="field">
            <span class="field__label">Fuente (URL real)</span>
            <input id="sourceUrl" class="input" placeholder="https://‚Ä¶" />
          </label>

          <div class="row row--wrap">
            <label class="chip">
              <input id="optIncludeLive" type="checkbox" checked />
              <span>Incluir ENVIVO</span>
            </label>
            <label class="chip">
              <input id="optIncludeSource" type="checkbox" checked />
              <span>Incluir Fuente</span>
            </label>
          </div>

          <label class="field">
            <span class="field__label">Plantilla</span>
            <textarea id="template" class="input input--area mono" rows="6"></textarea>
          </label>

          <div class="row row--wrap">
            <button id="btnTrim" class="btn btn--sm" type="button">Acortar titular</button>
            <button id="btnGenTags" class="btn btn--sm" type="button">Sugerir hashtags</button>
            <button id="btnCopyUrl" class="btn btn--sm" type="button">Copiar URL</button>
            <button id="btnCopy" class="btn btn--primary btn--sm" type="button">Copiar tweet</button>
            <button id="btnX" class="btn btn--sm" type="button">Abrir X</button>
            <button id="btnResetTemplate" class="btn btn--ghost btn--sm" type="button">Reset plantilla</button>
          </div>

          <div class="hr"></div>

          <div class="row row--between">
            <div id="warn" class="warn" aria-live="polite"></div>
            <div id="charCount" class="count">0</div>
          </div>

          <div class="previewWrap">
            <div class="previewTitle">Preview</div>
            <pre id="preview" class="preview"></pre>
          </div>

          <div class="hr"></div>

          <!-- SETTINGS -->
          <div class="panel__miniTitle">Filtros y rendimiento</div>

          <div class="grid3">
            <label class="field field--inline">
              <span class="field__label">Min edad</span>
              <input id="delayMin" class="input input--sm" type="number" min="0" max="180" value="10" />
            </label>

            <label class="chip chip--tight">
              <input id="optOnlyReady" type="checkbox" />
              <span>Solo ‚ÄúLISTO‚Äù</span>
            </label>

            <label class="chip chip--tight">
              <input id="optOnlySpanish" type="checkbox" checked />
              <span>ES prioridad</span>
            </label>

            <label class="field field--inline">
              <span class="field__label">Sort</span>
              <select id="sortBy" class="input input--sm">
                <option value="recent" selected>Reciente</option>
                <option value="impact">Impacto</option>
              </select>
            </label>

            <label class="chip chip--tight">
              <input id="optAutoRefresh" type="checkbox" checked />
              <span>Auto refresh</span>
            </label>

            <label class="field field--inline">
              <span class="field__label">Cada (s)</span>
              <input id="refreshSec" class="input input--sm" type="number" min="15" max="600" value="60" />
            </label>
          </div>

          <div class="grid3">
            <label class="chip chip--tight">
              <input id="optResolveLinks" type="checkbox" checked />
              <span>Resolver links</span>
            </label>

            <label class="chip chip--tight">
              <input id="optShowOriginal" type="checkbox" />
              <span>Mostrar original</span>
            </label>

            <label class="chip chip--tight">
              <input id="optHideUsed" type="checkbox" />
              <span>Ocultar usados</span>
            </label>

            <label class="field field--inline">
              <span class="field__label">Cat</span>
              <select id="catFilter" class="input input--sm">
                <option value="all" selected>All</option>
                <option value="politics">Politics</option>
                <option value="economy">Economy</option>
                <option value="war">War</option>
                <option value="tech">Tech</option>
                <option value="crime">Crime</option>
                <option value="health">Health</option>
                <option value="sports">Sports</option>
                <option value="ent">Ent</option>
              </select>
            </label>

            <label class="field field--inline">
              <span class="field__label">Mostrar</span>
              <input id="showLimit" class="input input--sm" type="number" min="10" max="50" value="10" />
            </label>

            <label class="field field--inline">
              <span class="field__label">Cap</span>
              <input id="fetchCap" class="input input--sm" type="number" min="80" max="2000" value="240" />
            </label>

            <label class="field field--inline">
              <span class="field__label">Batch</span>
              <input id="batchFeeds" class="input input--sm" type="number" min="4" max="50" value="12" />
            </label>
          </div>
        </div>
      </section>

      <!-- RIGHT: NEWS -->
      <section class="panel">
        <div class="panel__head">
          <div class="panel__title">Noticias</div>
          <div class="panel__sub">Click en una noticia para rellenar el tweet.</div>
        </div>

        <div class="panel__body panel__body--flush">
          <div id="newsList" class="newsList" aria-label="Lista de noticias"></div>
        </div>
      </section>
    </div>
  </main>

  <!-- MODAL FEEDS -->
  <div id="modal" class="modal hidden" aria-hidden="true" role="dialog" aria-label="Gesti√≥n de feeds">
    <div class="modal__panel">
      <div class="modal__head">
        <div>
          <div class="modal__title">Feeds</div>
          <div class="mini muted">Activa/desactiva, edita o importa/exporta JSON</div>
        </div>
        <button id="btnCloseModal" class="btn btn--sm" type="button">Cerrar</button>
      </div>

      <div class="modal__body">
        <div class="row row--3">
          <input id="newFeedName" class="input input--sm" placeholder="Nombre" />
          <input id="newFeedUrl" class="input input--sm" placeholder="URL RSS/Atom/JSON" />
          <button id="btnAddFeed" class="btn btn--primary btn--sm" type="button">A√±adir</button>
        </div>

        <div id="feedList" class="feedList"></div>

        <label class="field">
          <span class="field__label">Import / Export (JSON)</span>
          <textarea id="feedsJson" class="input input--area mono" rows="7"
            placeholder='[ { "name": "Reuters (RSS)", "url": "https://...", "enabled": true } ]'></textarea>
        </label>

        <div class="row row--4">
          <button id="btnExportFeeds" class="btn btn--sm" type="button">Export</button>
          <button id="btnImportFeeds" class="btn btn--sm" type="button">Import</button>
          <button id="btnRestoreDefaultFeeds" class="btn btn--sm" type="button">Defaults</button>
          <button id="btnSaveFeeds" class="btn btn--primary btn--sm" type="button">Guardar</button>
        </div>

        <div class="mini muted">
          Tip: Shift+click en ‚ÄúRefrescar‚Äù = force + reset backoff.
        </div>
      </div>
    </div>
  </div>

  <noscript>Necesitas JavaScript activado para usar este panel.</noscript>
  <script defer src="./app.js"></script>
</body>
</html>
